<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jogo da Forca da Privacidade</title>
  <style>
    :root {
      --brand: #0000cc;
      --accent: #f09319;
      --ok: #168f3b;
      --ink: #0c0c0d;
      --paper: #ffffff;
      --shadow: 0 4px 16px rgba(0,0,0,.12);
      --radius: 12px;
      --gap: clamp(8px, 1.8vw, 16px);
      --pad: clamp(10px, 2.2vw, 20px);
      --fs-xxs: clamp(10px, 2.4vw, 12px);
      --fs-xs: clamp(12px, 2.6vw, 14px);
      --fs-sm: clamp(14px, 2.8vw, 16px);
      --fs-md: clamp(16px, 3.2vw, 18px);
      --fs-lg: clamp(18px, 3.6vw, 22px);
      --fs-xl: clamp(22px, 4.4vw, 28px);
    }

    * { box-sizing: border-box; }

    html, body { height: 100%; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--ink);
      background-image: url('https://storyboardppd.github.io/hq/fundo/fundo_5.png');
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* ------- Header ------- */
    header {
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: saturate(120%) blur(4px);
      background: color-mix(in oklab, white 88%, transparent);
      border-bottom: 1px solid rgba(0,0,0,.06);
    }

    .header-wrap {
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: var(--gap);
      padding: var(--pad);
      max-width: 1100px;
      margin: 0 auto;
    }

    .brand {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      min-width: 48px;
    }

    .brand img { height: 36px; width: auto; }

    h1 {
      font-size: var(--fs-lg);
      line-height: 1.25;
      color: var(--brand);
      margin: 0;
      text-wrap: balance;
      text-align: center;
    }

    /* ------- Primary CTA ------- */
    .actions { display: flex; justify-content: center; padding: 4px var(--pad) var(--pad); }

    #iniciarButton {
      position: relative;
      padding: 12px 20px;
      font-size: var(--fs-md);
      background: var(--ok);
      color: white;
      border: 0;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: var(--shadow);
      touch-action: manipulation;
    }

    #iniciarButton:focus-visible { outline: 3px solid color-mix(in oklab, var(--ok) 60%, white); outline-offset: 2px; }

    #tooltip {
      display: none;
      position: absolute;
      top: calc(100% + 10px);
      left: 50%;
      transform: translateX(-50%);
      background: var(--accent);
      color: black;
      padding: 10px;
      border-radius: 8px;
      font-size: var(--fs-xs);
      width: min(88vw, 320px);
      text-align: center;
      box-shadow: var(--shadow);
    }

    /* ------- Info Row ------- */
    #info {
      display: grid;
      grid-auto-flow: column;
      justify-content: center;
      gap: clamp(10px, 4vw, 24px);
      color: white;
      font-weight: 700;
      font-size: var(--fs-sm);
      padding: 0 var(--pad) var(--pad);
      text-align: center;
      text-shadow: 0 1px 2px rgba(0,0,0,.35);
    }

    #palavra {
      font-size: var(--fs-xl);
      letter-spacing: 0.18em;
      text-align: center;
      color: white;
      font-weight: 800;
      margin: var(--gap) auto;
      text-shadow: 0 2px 6px rgba(0,0,0,.35);
      padding: 0 var(--pad);
      word-break: break-word;
    }

    /* ------- Main Container ------- */
    #game-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--gap);
      background: color-mix(in oklab, white 92%, transparent);
      margin: var(--pad) auto;
      padding: var(--pad);
      border-radius: var(--radius);
      width: min(96vw, 1100px);
      box-shadow: var(--shadow);
    }

    #forca { text-align: center; }
    #forca img { max-width: 100%; height: auto; }

    #perguntas {
      font-size: var(--fs-sm);
      max-height: 520px;
      overflow: auto;
      padding-right: 6px;
    }

    .checkbox-item { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 10px; }
    .checkbox-item input { margin-top: 2px; inline-size: 1.1rem; block-size: 1.1rem; }

    /* ------- Virtual Keyboard ------- */
    #teclado {
      display: none; /* será exibido via JS */
      margin: var(--gap) auto;
      padding: var(--pad);
      background: color-mix(in oklab, white 92%, transparent);
      border: 1px solid rgba(0,0,0,.08);
      border-radius: var(--radius);
      width: min(96vw, 700px);
      box-shadow: var(--shadow);
      position: relative;
    }

    .teclado {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(38px, 1fr));
      gap: 8px;
    }

    .teclado button {
      padding: clamp(8px, 2.2vw, 12px);
      background: var(--ok);
      color: white;
      font-weight: 700;
      border: 0;
      border-radius: 8px;
      cursor: pointer;
      font-size: var(--fs-sm);
      line-height: 1;
      min-height: 40px;
      touch-action: manipulation;
    }

    .teclado button:focus-visible { outline: 3px solid color-mix(in oklab, var(--ok) 60%, white); outline-offset: 2px; }

    footer {
      margin-top: auto;
      background: color-mix(in oklab, white 88%, transparent);
      text-align: center;
      padding: var(--pad);
      font-size: var(--fs-xs);
      border-top: 1px solid rgba(0,0,0,.06);
    }

    /* ------- Popup ------- */
    #overlay, #popup { display: none; position: fixed; inset: 0; }

    #overlay {
      background: rgba(0,0,0,.48);
      z-index: 1005;
    }

    #popup {
      z-index: 1010;
      width: min(92vw, 420px);
      margin: auto;
      background: var(--accent);
      color: #111;
      padding: var(--pad);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      display: none;
    }

    #popup p { margin: 0 0 12px; font-size: var(--fs-sm); }

    #popup button {
      padding: 10px 16px;
      background: var(--ok);
      color: white;
      border: 0;
      border-radius: 10px;
      font-size: var(--fs-sm);
      cursor: pointer;
    }

    /* ------- Small screens tweaks ------- */
    @media (max-width: 840px) {
      .header-wrap { grid-template-columns: auto 1fr; }
      .brand { order: 1; }
      h1 { order: 2; text-align: left; font-size: var(--fs-md); }
    }

    @media (max-width: 700px) {
      #game-container { grid-template-columns: 1fr; }
      #perguntas { max-height: 360px; }
      #info { grid-auto-flow: row; }
      .teclado { grid-template-columns: repeat(auto-fit, minmax(34px, 1fr)); }
    }

    /* Improve keyboard usability on mobile: sticky at bottom when visible */
    @media (max-width: 540px) {
      #teclado { position: sticky; bottom: 8px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-wrap">
      <div class="brand" aria-hidden="true">
        <img src="https://storyboardppd.github.io/hq/marca-serpro.png" alt="Logo" />
      </div>
      <h1>Jogo da Forca sobre Privacidade — Newsletter Junho/2025</h1>
      <span></span>
    </div>
  </header>

  <div class="actions">
    <button id="iniciarButton" onmouseover="mostrarDica()" onmouseout="esconderDica()" onclick="iniciarJogo()">
      Iniciar
      <span id="tooltip" role="tooltip">Selecione o desafio e use o teclado virtual. Quantos pontos você consegue?</span>
    </button>
  </div>

  <div id="teclado" aria-label="Teclado virtual" style="display:none">
    <div class="teclado" role="group" aria-label="Letras"></div>
  </div>

  <div id="palavra" aria-live="polite"></div>
  <div id="info" aria-live="polite">
    <div id="erros">Erros: 0</div>
    <div id="pontuacao">Pontuação: 0</div>
  </div>

  <main id="game-container">
    <section id="forca" aria-label="Desenho da forca">
      <img src="img/img1.png" alt="Forca" />
    </section>
    <section id="perguntas" aria-label="Perguntas"></section>
  </main>

  <footer>
    &copy; 2025 Departamento de Privacidade e Proteção de Dados Pessoais.
  </footer>

  <div id="overlay" role="presentation"></div>
  <div id="popup" role="dialog" aria-modal="true" aria-labelledby="popupMessage">
    <p id="popupMessage"></p>
    <button onclick="fecharPopup()">Fechar</button>
  </div>

  <script>
    // ------- Modelo de perguntas -------
    const perguntas = [
                           { question: "Adesão a normas e regulamentos legais, incluindo os relacionados à proteção de dados e privacidade.", answer: "CONFORMIDADE", nota: 10 },
                            { question: "Dado relativo a titular que não possa ser identificado, considerando a utilização de meios técnicos razoáveis e disponíveis na ocasião de seu tratamento.", answer: "DADOANONIMIZADO", nota: 10 },
                            { question: "Direito do titular de transferir seus dados a outro controlador.", answer: "DIREITODEPORTABILIDADE", nota: 10 },
                            { question: "É uma solicitação realizada pelo titular de dados pessoais à Autoridade Nacional de Proteção de Dados (ANPD), quando não conseguir exercer seus direitos perante o controlador de dados pessoais.", answer: "PETICAODOTITULAR", nota: 10 },
                            { question: "Documento que descreve como uma empresa coleta, usa, compartilha e protege os dados pessoais dos seus usuários.", answer: "POLITICADEPRIVACIDADE", nota: 10 },
                            { question: "É finalidade do relatório de impacto (RIPD) a avaliação de ....", answer: "RISCOS", nota: 10 },
                            { question: "Avaliação de proporcionalidade realizada com base no contexto e nas circunstâncias específicas do tratamento, que deve levar em consideração os impactos e os riscos aos direitos e liberdades dos titulares.", answer: "TESTEDEBALANCEAMENTO", nota: 10 },
                            { question: "É um teste que deve ser realizado sempre que o controlador e/ou terceiro optar por justificar ou entender aplicável a utilização da base legal do Legítimo Interesse.", answer: "TESTEDOLEGITIMOINTERESSE", nota: 10 },
                            { question: "Ato de transferir dados para outro país.", answer: "TRANSFERENCIAINTERNACIONAL", nota: 10 },
                            { question: "Fraqueza que pode ser explorada para causar um incidente de segurança.", answer: "VULNERABILIDADE", nota: 10 }
                          ];

    let palavraSecreta = '';
    let letrasAdivinhadas = [];
    let erros = 0;
    let pontuacao = 0;
    let contador_acertos = 0;
    let contador_erros = 0;

    function iniciarJogo() {
      const perguntasDiv = document.getElementById('perguntas');
      perguntasDiv.innerHTML = '';
      perguntas.forEach((pergunta, index) => {
        perguntasDiv.innerHTML += `
          <label class="checkbox-item">
            <input type="checkbox" id="pergunta${index}" value="${pergunta.answer}" data-nota="${pergunta.nota}" onchange="selecionarPergunta(this)" />
            <span>${pergunta.question} <strong>(${pergunta.nota})</strong></span>
          </label>`;
      });

      document.getElementById('teclado').style.display = 'block';
      resetarJogo(false); // inicia mantendo perguntas visíveis
    }

    function mostrarDica(){ document.getElementById('tooltip').style.display = 'block'; }
    function esconderDica(){ document.getElementById('tooltip').style.display = 'none'; }

    function selecionarPergunta(checkbox) {
      const checkboxes = document.querySelectorAll('#perguntas input[type=checkbox]');
      checkboxes.forEach(cb => {
        if (cb !== checkbox) cb.disabled = true; else cb.checked = true;
      });
      palavraSecreta = checkbox.value;
      letrasAdivinhadas = [];
      erros = 0;
      mostrarPalavra();
      atualizarForca();
      criarTeclado();
      // rola a área da palavra para o foco visual em telas pequenas
      document.getElementById('palavra').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function mostrarPalavra() {
      const exibicao = palavraSecreta.split('').map(l => letrasAdivinhadas.includes(l) ? l : '_').join(' ');
      document.getElementById('palavra').innerText = exibicao;
      document.getElementById('erros').innerText = `Erros: ${erros}`;
      document.getElementById('pontuacao').innerText = `Pontuação acumulada: ${pontuacao}`;

      if (!exibicao.includes('_') && palavraSecreta) {
        const checkbox = document.querySelector('#perguntas input[type=checkbox]:checked');
        if (checkbox) pontuacao += parseInt(checkbox.getAttribute('data-nota'), 10) || 0;
        contador_acertos++;
        mostrarPopup(`Você acertou e tem ${pontuacao} pontos acumulados!`);
        document.getElementById('pontuacao').innerText = `Pontuação acumulada: ${pontuacao}`;
        habilitarCheckboxes();
        verificarFim();
      }

      if (erros >= 7 && palavraSecreta) {
        contador_erros++;
        mostrarPopup(`Você errou! A palavra era: ${palavraSecreta}`);
        habilitarCheckboxes();
        verificarFim();
      }
    }

    function verificarFim(){
      if ((contador_erros + contador_acertos) >= perguntas.length) mostrarMensagemPersonalizada();
    }

    function mostrarMensagemPersonalizada() {
      let mensagem = '';
      if (pontuacao <= 60) mensagem = `Você obteve ${pontuacao} pontos e está no caminho do aprendizado!`;
      else if (pontuacao >= 70 && pontuacao < 100) mensagem = `Muito bom! Você conquistou ${pontuacao} pontos e é um Ninja da Privacidade!!`;
      else if (pontuacao >= 100) mensagem = 'Excelente desempenho!! Superou as expectativas. É o Mestre Jedi da Privacidade!';
      mostrarPopup(mensagem);
    }

    function habilitarCheckboxes() {
      const checkboxes = document.querySelectorAll('#perguntas input[type=checkbox]');
      checkboxes.forEach(cb => { if (!cb.checked) cb.disabled = false; });
    }

    function resetarJogo(resetPerguntas = true) {
      letrasAdivinhadas = [];
      erros = 0;
      pontuacao = resetPerguntas ? 0 : pontuacao; // mantém pontuação quando iniciar
      document.getElementById('palavra').innerText = '';
      document.getElementById('forca').innerHTML = `<img src="img/img1.png" alt="Forca" />`;
      document.getElementById('erros').innerText = 'Erros: 0';
      document.getElementById('pontuacao').innerText = `Pontuação: ${pontuacao}`;
      document.querySelector('.teclado').innerHTML = '';
      if (resetPerguntas){
        contador_acertos = 0; contador_erros = 0;
        document.getElementById('perguntas').querySelectorAll('input[type=checkbox]').forEach(cb => { cb.checked = false; cb.disabled = false; });
      }
      criarTeclado();
    }

    function adivinhar(letra) {
      if (!letra) return;
      if (!letrasAdivinhadas.includes(letra)) {
        letrasAdivinhadas.push(letra);
        if (!palavraSecreta.includes(letra)) erros++;
        mostrarPalavra();
        atualizarForca();
      }
    }

    function atualizarForca() {
      const etapa = Math.min(erros + 1, 7);
      document.getElementById('forca').innerHTML = `<img src="img/img${etapa}.png" alt="Forca etapa ${etapa}">`;
    }

    function criarTeclado() {
      const tecladoDiv = document.querySelector('.teclado');
      tecladoDiv.innerHTML = '';
      const letras = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
      letras.forEach(letra => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.textContent = letra;
        btn.setAttribute('aria-label', `Letra ${letra}`);
        btn.onclick = () => adivinhar(letra);
        tecladoDiv.appendChild(btn);
      });
    }

    function mostrarPopup(mensagem) {
      document.getElementById('popupMessage').innerText = mensagem;
      document.getElementById('popup').style.display = 'block';
      document.getElementById('overlay').style.display = 'block';
    }

    function fecharPopup() {
      document.getElementById('popup').style.display = 'none';
      document.getElementById('overlay').style.display = 'none';
    }

    // Teclas físicas: A-Z
    window.addEventListener('keydown', (e) => {
      const k = e.key?.toUpperCase();
      if (/^[A-Z]$/.test(k)) adivinhar(k);
    });

    document.addEventListener('DOMContentLoaded', () => {
      iniciarJogo();
      criarTeclado();
    });
  </script>
</body>
</html>
